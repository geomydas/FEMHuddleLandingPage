#!/usr/bin/env node
var I=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,i)=>(typeof require<"u"?require:e)[i]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});import it from"mri";function P(t,e=process.argv.slice(2)){let i=it(e),n={_:i._};for(let[o,{type:r,alias:s,default:f=r==="boolean"?!1:null}]of Object.entries(t)){if(n[o]=f,s){let l=s.slice(1);i[l]!==void 0&&(n[o]=L(i[l],r))}{let l=o.slice(2);i[l]!==void 0&&(n[o]=L(i[l],r))}}return n}function L(t,e){switch(e){case"string":return v(t);case"boolean":return k(t);case"number":return O(t);case"boolean | string":return k(t)??v(t);case"number | string":return O(t)??v(t);case"boolean | number":return k(t)??O(t);case"boolean | number | string":return k(t)??O(t)??v(t);default:throw new Error(`Unhandled type: ${e}`)}}function k(t){if(t===!0||t===!1)return t;if(t==="true")return!0;if(t==="false")return!1}function O(t){if(typeof t=="number")return t;{let e=Number(t);if(!Number.isNaN(e))return e}}function v(t){return`${t}`}import pt from"@parcel/watcher";import{IO as ut,Parsing as at,scanDir as G,scanFiles as ft}from"@tailwindcss/oxide";import{Features as J,transform as ct}from"lightningcss";import{existsSync as dt}from"node:fs";import Y from"node:fs/promises";import x from"node:path";import mt from"postcss";import gt from"postcss-import";import*as X from"tailwindcss";import ot from"node:fs";import M from"node:path";import{stripVTControlCharacters as st}from"node:util";import d from"picocolors";import{createRequire as rt}from"node:module";var T=rt(import.meta.url).resolve;function W(t){let e=typeof t=="number"?BigInt(t):t;return e<1000n?`${e}ns`:(e/=1000n,e<1000n?`${e}\xB5s`:(e/=1000n,e<1000n?`${e}ms`:(e/=1000n,e<60n?`${e}s`:(e/=60n,e<60n?`${e}m`:(e/=60n,e<24n?`${e}h`:(e/=24n,`${e}d`))))))}var F={indent:2};function C(){let{version:t}=JSON.parse(ot.readFileSync(T("tailwindcss/package.json"),"utf-8"));return`${d.italic(d.bold(d.blue("\u2248")))} tailwindcss ${d.blue(`v${t}`)}`}function N(t){return`${d.dim(d.blue("`"))}${d.blue(t)}${d.dim(d.blue("`"))}`}function U(t,e=process.cwd(),{preferAbsoluteIfShorter:i=!0}={}){let n=M.relative(e,t);return n.startsWith("..")||(n=`.${M.sep}${n}`),i&&n.length>t.length?t:n}function j(t,e){let i=t.split(" "),n=[],o="",r=0;for(let s of i){let f=st(s).length;r+f+1>e&&(n.push(o),o="",r=0),o+=(r?" ":"")+s,r+=f+(r?1:0)}return r&&n.push(o),n}function D(t){let e=W(t);return t<=50*1e6?d.green(e):t<=300*1e6?d.blue(e):t<=1e3*1e6?d.yellow(e):d.red(e)}function S(t,e=0){return`${" ".repeat(e+F.indent)}${t}`}function h(t=""){process.stderr.write(`${t}
`)}function u(t=""){process.stdout.write(`${t}
`)}import q from"node:fs/promises";import lt from"node:path";function V(){return new Promise((t,e)=>{let i="";process.stdin.on("data",n=>{i+=n}),process.stdin.on("end",()=>t(i)),process.stdin.on("error",n=>e(n))})}async function E(t,e){try{if(await q.readFile(t,"utf8")===e)return}catch{}await q.mkdir(lt.dirname(t),{recursive:!0}),await q.writeFile(t,e,"utf8")}var H=String.raw;function _(){return{"--input":{type:"string",description:"Input file",alias:"-i"},"--output":{type:"string",description:"Output file",alias:"-o"},"--watch":{type:"boolean | string",description:"Watch for changes and rebuild as needed",alias:"-w"},"--minify":{type:"boolean",description:"Optimize and minify the output",alias:"-m"},"--optimize":{type:"boolean",description:"Optimize the output without minifying"},"--cwd":{type:"string",description:"The current working directory",default:"."}}}async function Z(t){let e=x.resolve(t["--cwd"]);t["--output"]&&(t["--output"]=x.resolve(e,t["--output"])),t["--input"]&&t["--input"]!=="-"&&(t["--input"]=x.resolve(e,t["--input"]),dt(t["--input"])||(h(C()),h(),h(`Specified input file ${N(U(t["--input"]))} does not exist.`),process.exit(1)));let i=process.hrtime.bigint(),{candidates:n}=G({base:e}),[o,r]=await Q(t["--input"]?t["--input"]==="-"?await V():await Y.readFile(t["--input"],"utf-8"):H`
          @import '${T("tailwindcss/index.css")}';
        `,t["--input"]??e),s={css:"",optimizedCss:""};async function f(g,p){let m=g;if(p["--minify"]||p["--optimize"])if(g!==s.css){let $=ht(g,{file:p["--input"]??"input.css",minify:p["--minify"]??!1});s.css=g,s.optimizedCss=$,m=$}else m=s.optimizedCss;p["--output"]?await E(p["--output"],m):u(m)}let l=t["--input"]&&t["--input"]!=="-"?t["--input"]:process.cwd(),c=x.dirname(x.resolve(l));function a(g){return X.compile(g,{loadPlugin:p=>p[0]==="."?I(x.resolve(c,p)):I(p)})}let{build:b}=a(o);await f(b(n),t);let A=process.hrtime.bigint();h(C()),h(),h(`Done in ${D(A-i)}`),t["--watch"]&&(await pt.subscribe(e,async(g,p)=>{if(g){console.error(g);return}try{if(p.length===1&&p[0].path===t["--output"])return;let m=[],$="incremental";for(let w of p)if((w.type==="create"||w.type==="update")&&m.push({file:w.path,extension:x.extname(w.path).slice(1)}),r.includes(w.path)){$="full";break}let et=process.hrtime.bigint(),z="";if($==="full")n=G({base:e}).candidates,[o,r]=await Q(t["--input"]?await Y.readFile(t["--input"],"utf-8"):H`
                  @import '${T("tailwindcss/index.css")}';
                `,t["--input"]??e),b=a(o).build,z=b(n);else if($==="incremental"){let w=ft(m,ut.Sequential|at.Sequential);z=b(w)}await f(z,t);let nt=process.hrtime.bigint();h(`Done in ${D(nt-et)}`)}catch(m){m instanceof Error&&h(m.toString())}}),t["--watch"]!=="always"&&process.stdin.on("end",()=>{process.exit(0)}),process.stdin.resume())}function Q(t,e){return t.includes("@import")?mt().use(gt()).process(t,{from:e}).then(i=>[i.css,[e].concat(i.messages.filter(n=>n.type==="dependency").map(n=>n.file))]):[t,[e]]}function ht(t,{file:e="input.css",minify:i=!1}={}){return ct({filename:e,code:Buffer.from(t),minify:i,sourceMap:!1,drafts:{customMedia:!0},nonStandard:{deepSelectorCombinator:!0},include:J.Nesting,exclude:J.LogicalProperties,targets:{safari:16<<16|1024},errorRecovery:!0}).code.toString()}import y from"picocolors";function B({invalid:t,usage:e,options:i}){let n=process.stdout.columns;if(u(C()),t&&(u(),u(`${y.dim("Invalid command:")} ${t}`)),e&&e.length>0){u(),u(y.dim("Usage:"));for(let[o,r]of e.entries()){let s=r.slice(0,r.indexOf("[")),f=r.slice(r.indexOf("["));f=f.replace(/\[.*?\]/g,a=>y.dim(a));let c=j(f,n-F.indent-s.length-1);c.length>1&&o!==0&&u(),u(S(`${s}${c.shift()}`));for(let a of c)u(S(a,s.length))}}if(i){let o=0;for(let{alias:l}of Object.values(i))l&&(o=Math.max(o,l.length));let r=[],s=0;for(let[l,{alias:c}]of Object.entries(i)){let a=[c&&`${c.padStart(o)}`,c?l:" ".repeat(o+2)+l].filter(Boolean).join(", ");r.push(a),s=Math.max(s,a.length)}u(),u(y.dim("Options:"));let f=8;for(let{description:l,default:c=null}of Object.values(i)){let a=r.shift(),b=f+(s-a.length),A=2,g=n-a.length-b-A-F.indent,p=j(c!==null?`${l} ${y.dim(`[default:\u202F${N(`${c}`)}]`)}`:l,g);u(S(`${y.blue(a)} ${y.dim(y.gray("\xB7")).repeat(b)} ${p.shift()}`));for(let m of p)u(S(`${" ".repeat(a.length+b+A)}${m}`))}}}var K={"--help":{type:"boolean",description:"Display usage information",alias:"-h"}},R=P({..._(),...K}),tt=R._[0];tt&&(B({invalid:tt,usage:["tailwindcss [options]"],options:{..._(),...K}}),process.exit(1));(process.stdout.isTTY&&!R["--output"]||R["--help"])&&(B({usage:["tailwindcss [--input input.css] [--output output.css] [--watch] [options\u2026]"],options:{..._(),...K}}),process.exit(0));Z(R);
